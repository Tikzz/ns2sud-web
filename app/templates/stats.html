{% set has_loading = True %}
{% set page_title = 'Stats' %}
{% extends "master_template.html" %}
{% block title %}Stats{% endblock %}
{% block head %}
{% endblock %}
{% block content %}
<section class="section">
  <section id="hero-graph" class="hero">
    <div class="hero-body">
      <svg width="100%" height="0" id="graph_chart" class="border-bottom"></svg>
    </div>
    <div class="hero-foot no-pointer">
      <div class="container">
        <h1 class="title">Stats</h1>
        <h2 class="title is-size-5">Kills between players of the last 10 matches.</h2>
      </div>
    </div>
  </section>
  <div class="container" id="stats-container">
    <div id="main">
      {% raw %}
      <div class="tabs is-toggle is-fullwidth is-large">
        <ul>
          <router-link to="/matches" tag="li">
            <a>
              <span class="icon"><i class="far fa-map"></i></span>
              <span>Matches</span>
            </a>
          </router-link>
          <router-link to="/players" tag="li">
            <a>
              <span class="icon"><i class="far fa-user-circle"></i></span>
              <span>Players</span>
            </a>
          </router-link>
        </ul>
      </div>
      <router-view></router-view>
      {% endraw %}
    </div>
  </div>
</section>
{% endblock %}
{% block include_js %}
{% raw %}
<script type="text/x-template" id="matches-template">
  <div id="matches">
    <div class="control has-icons-left has-icons-right">
      <input class="input is-large" type="email" placeholder="Filter by match id or map" v-model="filter">
      <span class="icon is-medium is-left">
        <i class="fas fa-filter"></i>
      </span>
      <span class="icon is-medium is-right">
        <i class="fas fa-check"></i>
      </span>
    </div>
    <table class="table is-fullwidth">
      <thead>
        <tr>
          <th>ID</th>
          <th>Format</th>
          <th>Map</th>
          <th class="is-hidden-mobile">Winner</th>
          <th class="is-hidden-mobile">Duration</th>
          <th>Date</th>
        </tr>
      </thead>
      <tbody>
        <tr v-for="match in data">
          <th>
              <a v-bind:href="'/stats/match/'+match.roundId">{{ match.roundId }}</a>
          </th>
          <td>{{ match.maxPlayers1 }}v{{ match.maxPlayers2 }}</td>
          <td>{{ match.mapName }}</td>
          <td class="is-hidden-mobile">
            <template v-if="match.winningTeam == 1">Marines</template>
            <template v-if="match.winningTeam == 2">Aliens</template>
          </td>
          <td class="is-hidden-mobile">{{ match.roundLength }}</td>
          <td>{{ match.roundDateH }}</td>
        </tr>
      </tbody>
    </table>
    <nav class="pagination is-centered" role="navigation" v-bind:class="[{ 'is-loading': loading }]">
      <ul class="pagination-list">
        <li v-if="currentPage > 2"><a class="pagination-link" v-on:click="currentPage = 1">1</a></li>
        <li v-if="currentPage > 3"><span class="pagination-ellipsis">&hellip;</span></li>
        <li v-if="currentPage > 1"><a class="pagination-link" v-on:click="currentPage = currentPage - 1">{{
        currentPage - 1 }}</a></li>
        <li><a class="pagination-link is-current">{{ currentPage }}</a></li>
        <li v-if="currentPage < totalPages - 1"><a class="pagination-link"
          v-on:click="currentPage = currentPage + 1">{{ currentPage + 1
        }}</a></li>
        <li v-if="currentPage < totalPages - 2"><span class="pagination-ellipsis">&hellip;</span></li>
        <li><a class="pagination-link" v-on:click="currentPage = totalPages" v-if="currentPage < totalPages">{{
        totalPages }}</a></li>
      </ul>
    </nav>
  </div>
</script>
<script type="text/x-template" id="players-template">
  <div id="players">
    <div class="control has-icons-left has-icons-right">
      <input class="input is-large" type="email" placeholder="Filter by player name" v-model="filter">
      <span class="icon is-medium is-left">
        <i class="fas fa-filter"></i>
      </span>
      <span class="icon is-medium is-right">
        <i class="fas fa-check"></i>
      </span>
    </div>
    <table class="table is-fullwidth">
      <thead>
        <tr>
          <th>Steam ID</th>
          <th></th>
          <th>Name</th>
          <th class="is-hidden-mobile">Hive Skill</th>
          <th class="is-hidden-mobile">Other names</th>
          <th>Last seen</th>
        </tr>
      </thead>
      <tbody>
        <tr v-for="player in data">
          <th>
            <a v-bind:href="'/stats/player/'+player.steamId">{{ player.steamId }}</a>
          </th>
          <td>
            <figure class="image is-24x24" v-if="player.discordAvatar">
                <img class="is-rounded" v-bind:src="player.discordAvatar">
            </figure>
          </td>
          <td>{{ player.playerName }}</td>
          <td class="is-hidden-mobile">{{ player.hiveSkill }}</td>
          <td class="is-hidden-mobile">{{ player.name_list }}</td>
          <td>{{ player.lastSeenH }}</td>
        </tr>
      </tbody>
    </table>
    <nav class="pagination is-centered" role="navigation" v-bind:class="[{ 'is-loading': loading }]">
      <ul class="pagination-list">
        <li v-if="currentPage > 2"><a class="pagination-link" v-on:click="getData(1)">1</a></li>
        <li v-if="currentPage > 3"><span class="pagination-ellipsis">&hellip;</span></li>
        <li v-if="currentPage > 1"><a class="pagination-link" v-on:click="getData(currentPage - 1)">{{
        currentPage - 1 }}</a></li>
        <li><a class="pagination-link is-current">{{ currentPage }}</a></li>
        <li v-if="currentPage < totalPages - 1"><a class="pagination-link"
          v-on:click="getData(currentPage + 1)">{{ currentPage + 1
        }}</a></li>
        <li v-if="currentPage < totalPages - 2"><span class="pagination-ellipsis">&hellip;</span></li>
        <li><a class="pagination-link" v-on:click="getData(totalPages)" v-if="currentPage < totalPages">{{
        totalPages }}</a></li>
      </ul>
    </nav>
  </div>
</div>
</script>
<script src="/static/js/ext/d3.min.js"></script>
<script src="/static/js/graph_chart.js"></script>
<script src="/static/js/ext/vue.min.js"></script>
<script src="/static/js/ext/vue-router.min.js"></script>
<script src="/static/js/stats-vue.js"></script>
{% endraw %}
{% endblock %}